[HEADER]
VERSION=4

[_EXTENSION]
TORQUE_MODE_EX=2

; Disabled due to custom COSMIC flex implementation
;[_EXTENSION_FLEX]
;TORSIONAL_STIFFNESS=350  ; Nm/deg -- Hornman paper says 140, but that seems low
;TORSIONAL_DAMPING=3           ; Nm/(deg/s)

[BASIC]
WHEELBASE=1.05 ; Wheelbase distance in meters -- correct to rules (1050mm wheelbase model)
CG_LOCATION=0.366 ; Front weight distribution in percentage -- based off of guessed CG empty in Blender, adjusted for ideal CG of 0.43
; adjust the seat location for CG adjustments

[ARB]
FRONT=0 ; Front antiroll bar stifness. in Nm -- JPG says to keep these at 0
REAR=0 ; Rear antiroll bar stifness. in Nm -- JPG says to keep these at 0

; New-gen, clean room implementation of the front suspension configuration concept I designed for ACKarting's karts

[FRONT]
TYPE=COSMIC
RIM_OFFSET=0.0 ; -- guessed
BASEY=-0.163 ; Distance of CG from the center of the wheel in meters. Front Wheel Radius+BASEY=front CoG. Actual CG height =(FWR+FBasey)+(RWR+Rbasey))/CG_LOCATION% -- based off of guessed CG empty in Blender, correct to model
TRACK=1 ; Track width in meters (from pivot 3D placement of the 3d model of a wheel) -- correct to model
HUB_MASS=5 ; -- guessed
TOE_OUT=0.00 ; -- guessed
STATIC_CAMBER=0 ; -- placeholder

BODY_0_NAME=SPINDLE ; Wheel and tierod connect to this. Rotates on angled kingpin
BODY_0_MASS=2 ; -- guessed
BODY_0_POS=0.158, 0, 0 ; SPINDLE in Blender
BODY_0_MIRROR=1

BODY_1_NAME=STEERSHAFT ; One of these located in the center of the car
BODY_1_MASS=2 ; -- guessed
BODY_1_POS=0.5, 0.102, -0.123
BODY_1_MIRROR=0

BODY_2_NAME=CHASSIS_FLEX_BODY_INTER
BODY_2_MASS=5 ; -- guessed
BODY_2_CARPOS=0, -0.25, 0.2
BODY_2_MIRROR=0

BODY_3_NAME=CHASSIS_FLEX_BODY_FRONT ; Front body to which all the front suspension components are attached; attached to the chassis via a longitudinal hinge with a torsion bar to simulate body flex
BODY_3_MASS=5 ; -- guessed
BODY_3_CARPOS=0, -0.25, 0.2
BODY_3_MIRROR=0

BODY_4_NAME=KINGPIN_ADJUSTER ; Body to which the hub is partially attached
BODY_4_POS=0.166, 0.033, -0.009
BODY_4_MIRROR=1

J0=KINGPIN_TOPJOINT ; Top joint of kingpin, joins chassis and spindle. TODO: Make adjustable along lateral and longitudinal axes
J0_BODY_A=KINGPIN_ADJUSTER
J0_BODY_B=SPINDLE
J0_POS=0.166, 0.033, -0.009 ; KINGPIN_TOP in Blender
J0_PARITY=-1
J0_KP=1 ; Sets up FFB and marks as the top kingpin joint

J1=KINGPIN_BOTTOMJOINT ; Bottom joint of kingpin, joins chassis and spindle
J1_BODY_A=CHASSIS_FLEX_BODY_FRONT
J1_BODY_B=SPINDLE
J1_POS=0.15, -0.033, 0.009 ; KINGPIN_BOTTOM in Blender
J1_PARITY=-1
J1_KP=0 ; Sets up FFB and marks as the bottom kingpin joint

J2=STEERSHAFT_TOPJOINT ; what the bottom of the steering shaft is constrained by
J2_BODY_A=CHASSIS_FLEX_BODY_FRONT
J2_BODY_B=STEERSHAFT
J2_POS=0.5, 0.314, -0.307 ; STEERSHAFT_TOPJOINT in Blender
J2_PARITY=-1

J3=STEERSHAFT_BOTTOMJOINT ; what the top of the steering shaft is constrained by
J3_BODY_A=CHASSIS_FLEX_BODY_FRONT
J3_BODY_B=STEERSHAFT
J3_POS=0.5, -0.057, 0.013 ; STEER_HR or STEER_LR position in Blender
J3_PARITY=-1

DJ0=TRACK_WIDTH_CONTROLLER ; Controls the front track width (distance between HUB and SPINDLE) via a setup option
DJ0_BODY_A=SPINDLE
DJ0_BODY_B=HUB_L
DJ0_POS_A=.158, .15, 0 ; Offset vertically by .15 m for visibility reasons, shouldn't affect functionality
DJ0_POS_B=0, .15, 0

DJ1=TIE_ROD ; Actual tie rods linking steering shaft and hubs
DJ1_BODY_A=STEERSHAFT
DJ1_BODY_B=SPINDLE
DJ1_POS_A=.485, -.0033, -.0833
DJ1_POS_A_1=0.485, -0.011, -0.092
DJ1_POS_A_2=.485, -.018, -.1004
DJ1_POS_B=0.187, -0.043, -0.118
DJ1_POS_B_1=0.175, -0.042, -0.114
DJ1_POS_B_2=0.163, -0.04, -0.11

DJ2=KINGPIN_ADJ_HEIGHT_KEEPER ; Keeps the KINGPIN_ADJUSTER body at a fixed height from the bottom kingpin joint to constrain all 3 axes of movement with the adjusters
DJ2_BODY_A=CHASSIS_FLEX_BODY_FRONT
DJ2_BODY_B=KINGPIN_ADJUSTER
DJ2_POS_A=0.15, -0.033, 0.009
DJ2_POS_B=0.166, 0.033, -0.009

DJ3=KINGPIN_ADJ_CAMBER ; Keeps the KINGPIN_ADJUSTER body at a fixed height from the bottom kingpin joint to constrain all 3 axes of movement with the adjusters
DJ3_BODY_A=CHASSIS_FLEX_BODY_FRONT
DJ3_BODY_B=KINGPIN_ADJUSTER
DJ3_POS_A=0.215, 0.021, -0.009
DJ3_POS_B=0.166, 0.033, -0.009

DJ4=KINGPIN_ADJ_CASTER ; Keeps the KINGPIN_ADJUSTER body at a fixed height from the bottom kingpin joint to constrain all 3 axes of movement with the adjusters
DJ4_BODY_A=CHASSIS_FLEX_BODY_FRONT
DJ4_BODY_B=KINGPIN_ADJUSTER
DJ4_POS_A=0.166, 0.046, 0.039
DJ4_POS_B=0.166, 0.033, -0.009

HJ0=CHASSIS_FLEX_HINGE_LONG ; Connects CHASSIS and CHASSIS_FLEX_BODY_INTER to simulate chassis flex about the longitudinal axis
HJ0_BODY_A=CHASSIS
HJ0_BODY_B=CHASSIS_FLEX_BODY_INTER
HJ0_CARPOS_A=0, -0.25, 0.1
HJ0_CARPOS_B=0, -0.25, 0.3
HJ0_PARITY=0

HJ1=CHASSIS_FLEX_HINGE_LATERAL ; Connects CHASSIS_FLEX_BODY_INTER and CHASSIS_FLEX_BODY_FRONT to simulate chassis flex about the lateral axis
HJ1_BODY_A=CHASSIS_FLEX_BODY_INTER
HJ1_BODY_B=CHASSIS_FLEX_BODY_FRONT
HJ1_CARPOS_A=0.1, -0.25, 0.2
HJ1_CARPOS_B=-0.1, -0.25, 0.2
HJ1_PARITY=0

SLIDER_0=TRACK_WIDTH_SLIDER ; Allows the HUB to move relative to the SPINDLE for track width adjustments
SLIDER_0_BODY_A=SPINDLE
SLIDER_0_BODY_B=HUB_L
SLIDER_0_AXIS=1, 0, 0 ; slides in the X direction (laterally)

STEER_JOINT_0=STEER_FORCE ; Functions as hands on a steering wheel; rotates the STEERSHAFT to move the tierods to rotate the SPINDLEs to move the wheels
STEER_JOINT_0_BODY_A=CHASSIS_FLEX_BODY_FRONT
STEER_JOINT_0_BODY_B=STEERSHAFT
STEER_JOINT_0_POS_A=-0.5, 0.314, -0.307 ; Car side
STEER_JOINT_0_POS_B=0.5, 0.2487, -0.3828 ; Wheel side
STEER_JOINT_0_PARITY=-1 ; Only one, two might break things as the STEERSHAFTs are already tied together

[FRONT_TORSION_0]
RATE=2200 ; kart_torsion.png about 2200
PRELOAD_TORQUE=0
HINGE=CHASSIS_FLEX_HINGE_LONG
PARITY=0

[FRONT_TORSION_1]
RATE=1000 ; Archpulled 1000
PRELOAD_TORQUE=0
HINGE=CHASSIS_FLEX_HINGE_LATERAL
PARITY=0

[FRONT_DAMPER_0] ; chassis flex damper
DAMP_BUMP=200
DAMP_FAST_BUMP=200
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=200
DAMP_FAST_REBOUND=200
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS
BODY_B=CHASSIS_FLEX_BODY_INTER
POS_A=-0.2, 0.5, 0.0
POS_B=-0.2, 0.0, 0.0
MIN_LENGTH=0.3
MAX_LENGTH=0.6
END_RATE=50000
END_VTAPER=0.02
END_VMAX=0.10

[FRONT_DAMPER_1] ; chassis side flex damper
DAMP_BUMP=500
DAMP_FAST_BUMP=500
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=500
DAMP_FAST_REBOUND=500
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS_FLEX_BODY_INTER
BODY_B=CHASSIS_FLEX_BODY_FRONT
POS_A=-0.15, 0.5, 0.1
POS_B=-0.15, 0.0, 0.1
MIN_LENGTH=0.3
MAX_LENGTH=0.6
END_RATE=50000
END_VTAPER=0.02
END_VMAX=0.05


[REAR]
TYPE=COSMIC
BASEY=-0.163 ; Distance of CG from the center of the wheel in meters. Rear Wheel Radius+BASEY=Rear CoG  Actual CG height =(FWR+FBasey)+(RWR+Rbasey))/CG_LOCATION% -- based off of guessed CG empty in Blender, correct to model
TRACK=1.217 ; -- 55 inch outside to outside converted per CKNA rules which is 1397mm, Scotty says 1400mm outside to outside and to use 1375mm as a starting point; correct to model would be 1.17 (wheel center to wheel center) 
ROD_LENGTH=0.00
HUB_MASS=5
RIM_OFFSET=0.0
TOE_OUT=0.0000
STATIC_CAMBER=0.0

BODY_0_NAME=AXLE
BODY_0_MASS=2
BODY_0_POS=0.2985, 0, 0
BODY_0_MIRROR=1

HJ0=BEARING_HINGE ; simulates the outer portion of the axle flexing
HJ0_BODY_B=AXLE
HJ0_POS_A=0.2985, 0, -0.05
HJ0_POS_B=0.2985, 0, 0.05
HJ0_PARITY=-1

SLIDER_0=TRACK_WIDTH_SLIDER
SLIDER_0_BODY_A=AXLE
SLIDER_0_BODY_B=HUB_L
SLIDER_0_AXIS=1, 0, 0

DJ0=TRACK_WIDTH_CONTROLLER
DJ0_BODY_A=AXLE
DJ0_BODY_B=HUB_L
DJ0_POS_A=0.33, .1, 0
DJ0_POS_B=0, .1, 0
DJ0_LENGTH_OFFSET = 0.0

BODY_1_NAME=SEAT
BODY_1_MASS=50 ; Weight of seat and extra weight for portion of driver in seat, in kg
BODY_1_INERTIA=0.1, 0.15, 0.1
BODY_1_POS=0.6085, 0.1, 0.1 ; adjust this for CG adjustments (lat, vert, long)
BODY_1_MIRROR=0

BODY_2_NAME=SEAT_LONG
BODY_2_POS=0.6085, 0.08, 0.03
BODY_2_MIRROR=0

SLIDER_1=SEAT_LONG_SLIDER
SLIDER_1_BODY_A=SEAT_LONG
SLIDER_1_BODY_B=CHASSIS
SLIDER_1_AXIS=0, 0, 1

DJ1=SEAT_LONG_POSITION_CONTROLLER
DJ1_BODY_A=SEAT_LONG
DJ1_BODY_B=CHASSIS
DJ1_POS_A=0.5885, 0.073, 0.378 ; displaced by -0.02m in X and Z for visibility
DJ1_POS_B=0.5885, 0.073, 0.078 ; 0.3m long forwards of seat
DJ1_PARITY=0

SLIDER_2=SEAT_VERT_SLIDER
SLIDER_2_BODY_A=SEAT_LONG
SLIDER_2_BODY_B=SEAT
SLIDER_2_AXIS=0, 1, 0

DJ2=SEAT_VERT_POSITION_CONTROLLER
DJ2_BODY_A=SEAT_LONG
DJ2_BODY_B=SEAT
DJ2_POS_A=0.6285, 0.073, 0.1 ; displaced by 0.02m in X and -0.02m Z for visibility
DJ2_POS_B=0.6285, 0.373, 0.1
DJ2_PARITY=0

[REAR_DAMPER_0] ; rear axle vertical damper
DAMP_BUMP=3000
DAMP_FAST_BUMP=3000
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=3000
DAMP_FAST_REBOUND=3000
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS
BODY_B=HUB_L
POS0=0.0, 0.5, 0.0
POS1=0.0, 0.0, 0.0
MIN_LENGTH=0.4
MAX_LENGTH=0.6
END_RATE=1000
END_VTAPER=0.02
END_VMAX=0.05

[REAR_TORSION_0]
RATE=795.5 ; Nm/deg - FEA says 795.5 for a 1.25mm axle (soft)
PRELOAD_TORQUE=0 ; Nm of preload to apply to hinge
HINGE=BEARING_HINGE ; hinge that torsion bar is attached to
PARITY=-1

[GRAPHICS_OFFSETS]
WHEEL_LF=-0.00					;Left front graphical offset of the wheel positioning in the x axis (width). + is left - is right movement
SUSP_LF=-0.00					;Left front graphical offset of the suspension positioning in the x axis (width). + is left - is right movement
WHEEL_RF=0.00					; Right front as above
SUSP_RF=0.00				; Right front as above
WHEEL_LR=-0.00					; Left rear as above
SUSP_LR=-0.00					; Left rear as above
WHEEL_RR=0.00					; Right rear as above
SUSP_RR=0.00				; Right rear as above

[DAMAGE]
MIN_VELOCITY=40				; MINUMUM VELOCITY TO START TAKING DAMAGE
GAIN=0.0000					; AMOUNT OF STEER ROD DEFLECTION FOR IMPACT KMH
MAX_DAMAGE=0.05			; MAXIMUM AMOUNT OF STEER ROD DEFLECTION ALLOWED
DEBUG_LOG=1					; ACTIVATES DAMAGE DEBUG IN THE LOG

