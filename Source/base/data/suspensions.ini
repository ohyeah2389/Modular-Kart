[HEADER]
VERSION=4

[_EXTENSION]
TORQUE_MODE_EX=2
REPAIR_WHEELS=0

; Disabled due to custom COSMIC flex implementation
;[_EXTENSION_FLEX]
;TORSIONAL_STIFFNESS=350  ; Nm/deg -- Hornman paper says 140, but that seems low
;TORSIONAL_DAMPING=3           ; Nm/(deg/s)

[BASIC]
WHEELBASE=1.05 ; Wheelbase distance in meters -- 1050mm wheelbase model
CG_LOCATION=0.43 ; Front weight distribution in percentage
; Standard kart tuning tips give a 43% weight distribution as optimum

[ARB]
FRONT=0 ; Front antiroll bar stifness. in Nm -- JPG says to keep these at 0
REAR=0 ; Rear antiroll bar stifness. in Nm -- JPG says to keep these at 0


; Clean room implementation of the front suspension configuration concept I designed for ACKarting's karts


[FRONT]
TYPE=COSMIC
RIM_OFFSET=0.01 ; -- Easy way to change track width without changing suspension geo; is subtractive from track width (lower than 0 widens the track)
BASEY=-0.185 ; Distance of CG from the center of the wheel in meters. Front Wheel Radius+BASEY=front CoG. Actual CG height =(FWR+FBasey)+(RWR+Rbasey))/CG_LOCATION%
TRACK=1 ; Track width in meters (from pivot 3D placement of the 3d model of a wheel) -- correct to model
HUB_MASS=5 ; -- guessed
TOE_OUT=0.00 ; -- guessed
STATIC_CAMBER=0 ; -- placeholder

BODY_0_NAME=STEERSHAFT ; One of these located in the center of the car
BODY_0_MASS=2 ; -- guessed
BODY_0_POS=0.5, 0.102, -0.123
BODY_0_MIRROR=0

BODY_1_NAME=CHASSIS_FLEX_BODY_FRONT ; Front chassis flex body to which the left and right sub-chassis flex bodies are attached; attached to the root chassis via a longitudinal hinge with a torsion bar to simulate body flex about the longitudinal axis
BODY_1_MASS=15 ; -- guessed
BODY_1_INERTIA=0.5, 0.05, 0.5
BODY_1_CARPOS=0, -0.2, 0.3
BODY_1_MIRROR=0

BODY_2_NAME=SPINDLE
BODY_2_MASS=2 ; -- guessed
BODY_2_POS=0.1579, 0, 0
BODY_2_MIRROR=1

BODY_3_NAME=CHASSIS_FLEX_BODY_FRONT_SIDE ; Body to which the front wheel components are attached; attached to the front chassis flex body via a central longitudinal hinge to simulate localized bending about the central longitudinal axis
BODY_3_MASS=15 ; -- guessed
BODY_3_INERTIA=0.25, 0.05, 0.25
BODY_3_CARPOS=0.25, -0.2, 0.6
BODY_3_MIRROR=1

J0=KINGPIN_TOPJOINT ; Top joint of kingpin, joins chassis and spindle.
J0_BODY_A=CHASSIS_FLEX_BODY_FRONT_SIDE
J0_BODY_B=SPINDLE
J0_POS=0.165823, 0.033000, -0.007316 ; KPI 13.5 caster -12.5
J0_PARITY=-1
J0_KP=1 ; Sets up FFB and marks as the top kingpin joint

J1=KINGPIN_BOTTOMJOINT ; Bottom joint of kingpin, joins chassis and spindle
J1_BODY_A=CHASSIS_FLEX_BODY_FRONT_SIDE
J1_BODY_B=SPINDLE
J1_POS=0.149977, -0.033000, 0.007316 ; KPI 13.5 caster -12.5
J1_PARITY=-1
J1_KP=0 ; Sets up FFB and marks as the bottom kingpin joint

J2=STEERSHAFT_TOPJOINT ; what the bottom of the steering shaft is constrained by
J2_BODY_A=CHASSIS_FLEX_BODY_FRONT
J2_BODY_B=STEERSHAFT
J2_POS=0.5, 0.314, -0.307
J2_PARITY=-1

J3=STEERSHAFT_BOTTOMJOINT ; what the top of the steering shaft is constrained by
J3_BODY_A=CHASSIS_FLEX_BODY_FRONT
J3_BODY_B=STEERSHAFT
J3_POS=0.5, -0.057, 0.013
J3_PARITY=-1

DJ0=TIE_ROD ; Actual tie rods linking steering shaft and hubs
DJ0_BODY_A=STEERSHAFT
DJ0_BODY_B=SPINDLE
DJ0_POS_A=0.485, -0.02, -0.069 ; top setting
DJ0_POS_A_1=0.485, -0.028, -0.077 ; middle setting
DJ0_POS_A_2=0.485, -0.035, -0.086 ; bottom setting
DJ0_POS_A_3=0.485, -0.043, -0.094 ; extension setting
DJ0_POS_B=0.187, -0.043, -0.118 ; inner setting
DJ0_POS_B_1=0.175, -0.042, -0.114 ; middle setting
DJ0_POS_B_2=0.163, -0.040, -0.110 ; outer setting

DJ1=TRACK_WIDTH_ADJUST_FRONT ; Controls position of HUB along slider TRACK_WIDTH_FRONT
DJ1_BODY_A=SPINDLE
DJ1_BODY_B=HUB_L
DJ1_POS_A=0.1, 0.01, 0
DJ1_POS_B=0, 0.01, 0

HJ0=CHASSIS_FLEX_HINGE_FRONT ; Connects CHASSIS and CHASSIS_FLEX_BODY_FRONT
HJ0_BODY_A=CHASSIS
HJ0_BODY_B=CHASSIS_FLEX_BODY_FRONT
HJ0_CARPOS_A=0, -0.2, 0.0
HJ0_CARPOS_B=0, -0.2, 0.3
HJ0_PARITY=0

HJ1=CHASSIS_FLEX_HINGE_FRONT_SIDE ; Connects CHASSIS_FLEX_BODY_FRONT and CHASSIS_FLEX_BODY_FRONT_SIDE
HJ1_BODY_A=CHASSIS_FLEX_BODY_FRONT
HJ1_BODY_B=CHASSIS_FLEX_BODY_FRONT_SIDE
HJ1_CARPOS_A=0, -0.2, 0.35
HJ1_CARPOS_B=0, -0.2, 0.65
HJ1_PARITY=-1

SLIDER_0=TRACK_WIDTH_FRONT
SLIDER_0_BODY_A=SPINDLE
SLIDER_0_BODY_B=HUB_L
SLIDER_0_POS_A=0.1, 0, 0
SLIDER_0_POS_B=0, 0, 0

STEER_JOINT_0=STEER_FORCE ; Functions as hands on a steering wheel; rotates the STEERSHAFT to move the tierods to rotate the SPINDLEs to move the wheels
STEER_JOINT_0_BODY_A=CHASSIS_FLEX_BODY_FRONT
STEER_JOINT_0_BODY_B=STEERSHAFT
STEER_JOINT_0_POS_A=-2, 0.2487, -0.3828 ; Car side
STEER_JOINT_0_POS_B=0.5, 0.2487, -0.3828 ; Wheel side
STEER_JOINT_0_PARITY=0

[FRONT_TORSION_0]
RATE=825 ; System target 250
PRELOAD_TORQUE=0
HINGE=CHASSIS_FLEX_HINGE_FRONT
PARITY=0

[FRONT_TORSION_1]
RATE=575
PRELOAD_TORQUE=0
HINGE=CHASSIS_FLEX_HINGE_FRONT_SIDE
PARITY=-1

[FRONT_DAMPER_0] ; chassis front flex damper
DAMP_BUMP=100
DAMP_FAST_BUMP=100
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=100
DAMP_FAST_REBOUND=100
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS
BODY_B=CHASSIS_FLEX_BODY_FRONT
POS_A=0, 0.5, 0
POS_B=0, 0.0, 0
MIN_LENGTH=0.3
MAX_LENGTH=0.7
END_RATE=100
END_VTAPER=0.02
END_VMAX=0.2

[FRONT_DAMPER_1] ; chassis front flex damper
DAMP_BUMP=100
DAMP_FAST_BUMP=100
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=100
DAMP_FAST_REBOUND=100
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS_FLEX_BODY_FRONT
BODY_B=CHASSIS_FLEX_BODY_FRONT_SIDE
POS_A=0, 0.5, 0
POS_B=0, 0.0, 0
MIN_LENGTH=0.3
MAX_LENGTH=0.7
END_RATE=100
END_VTAPER=0.02
END_VMAX=0.2


[REAR]
TYPE=COSMIC
RIM_OFFSET=0.03 ; -- Easy way to change track width without changing suspension geo; is subtractive from track width (lower than 0 widens the track)
BASEY=-0.185 ; Distance of CG from the center of the wheel in meters. Rear Wheel Radius+BASEY=Rear CoG  Actual CG height =(FWR+FBasey)+(RWR+Rbasey))/CG_LOCATION%
TRACK=1.217 ; -- 55 inch outside to outside converted per CKNA rules which is 1397mm, Scotty says 1400mm outside to outside and to use 1375mm as a starting point; correct to model would be 1.17 (wheel center to wheel center) 
ROD_LENGTH=0.00
HUB_MASS=8
TOE_OUT=0.0000
STATIC_CAMBER=0.0

BODY_0_NAME=CHASSIS_FLEX_BODY_REAR ; Rear body to which all the rear suspension components are attached; attached to the chassis via a longitudinal hinge with a torsion bar to simulate body flex about the longitudinal axis
BODY_0_MASS=40 ; tune this to tune F/R CG
BODY_0_INERTIA=0.5, 0.05, 0.5
BODY_0_CARPOS=0, -0.2, -0.4
BODY_0_MIRROR=0
ENGINE_TORQUE_BODY=CHASSIS_FLEX_BODY_REAR

HJ0=CHASSIS_FLEX_HINGE_REAR ; Connects CHASSIS and CHASSIS_FLEX_BODY_REAR
HJ0_BODY_A=CHASSIS
HJ0_BODY_B=CHASSIS_FLEX_BODY_REAR
HJ0_CARPOS_A=0, -0.2, -0.05
HJ0_CARPOS_B=0, -0.2, -0.35
HJ0_PARITY=0

SLIDER_0=TRACK_WIDTH_REAR
SLIDER_0_BODY_A=CHASSIS_FLEX_BODY_REAR
SLIDER_0_BODY_B=HUB_L
SLIDER_0_POS_A=0.1, 0, 0
SLIDER_0_POS_B=0, 0, 0

DJ0=TRACK_WIDTH_ADJUST_REAR ; Controls position of HUB along slider TRACK_WIDTH_REAR
DJ0_BODY_A=CHASSIS_FLEX_BODY_REAR
DJ0_BODY_B=HUB_L
DJ0_POS_A=0.1, 0.01, 0
DJ0_POS_B=0, 0.01, 0

BODY_1_NAME=DRV_HIPS_TRANSLATE_LAT
BODY_1_MASS=1
BODY_1_POS=0.5585, 0.013, 0.409
BODY_1_MIRROR=0

SLIDER_1=DRV_HIPS_TRANSLATE_LAT_SLIDER
SLIDER_1_BODY_A=CHASSIS
SLIDER_1_BODY_B=DRV_HIPS_TRANSLATE_LAT
SLIDER_1_POS_A=0.5085, 0.013, 0.409
SLIDER_1_POS_B=0.6085, 0.013, 0.409

BODY_2_NAME=DRV_HIPS_TRANSLATE_LONG
BODY_2_MASS=1
BODY_2_POS=0.5585, 0.013, 0.409
BODY_2_MIRROR=0

SLIDER_2=DRV_HIPS_TRANSLATE_LONG_SLIDER
SLIDER_2_BODY_A=DRV_HIPS_TRANSLATE_LAT
SLIDER_2_BODY_B=DRV_HIPS_TRANSLATE_LONG
SLIDER_2_POS_A=0.5585, 0.013, 0.309
SLIDER_2_POS_B=0.5585, 0.013, 0.509

BODY_3_NAME=DRV_HIPS
BODY_3_MASS=15 ; whole driver is 80kg, upper body probably 50kg
BODY_3_POS=0.5585, 0.013, 0.409
BODY_3_INERTIA=0.3, 0.2, 0.4
BODY_3_MIRROR=0

SLIDER_3=DRV_HIPS_TRANSLATE_LONG_SLIDER
SLIDER_3_BODY_A=DRV_HIPS_TRANSLATE_LONG
SLIDER_3_BODY_B=DRV_HIPS
SLIDER_3_POS_A=0.5585, -0.087, 0.409
SLIDER_3_POS_B=0.5585, 0.113, 0.409

BODY_4_NAME=DRV_CHEST_ROLL
BODY_4_MASS=1
BODY_4_POS=0.5585, 0.113, 0.239
BODY_4_MIRROR=0

HJ1=DRV_SPINE_ROLL
HJ1_BODY_A=DRV_HIPS
HJ1_BODY_B=DRV_CHEST_ROLL
HJ1_POS_A=0.5585, 0.2, 0.249
HJ1_POS_B=0.5585, 0.2, 0.229
HJ1_PARITY=0

BODY_5_NAME=DRV_CHEST
BODY_5_MASS=25 ; whole driver is 80kg, upper body probably 50kg
BODY_5_POS=0.5585, 0.313, 0.204
BODY_5_INERTIA=0.3, 0.4, 0.25
BODY_5_MIRROR=0

HJ2=DRV_SPINE_PITCH
HJ2_BODY_A=DRV_CHEST_ROLL
HJ2_BODY_B=DRV_CHEST
HJ2_POS_A=0.5485, 0.113, 0.239
HJ2_POS_B=0.5685, 0.113, 0.239
HJ2_PARITY=0

[REAR_TORSION_0]
RATE=650 ; Hornman test 142 Nm/deg for entire system, system target 250
PRELOAD_TORQUE=0
HINGE=CHASSIS_FLEX_HINGE_REAR
PARITY=0

[REAR_TORSION_1] ; DRV_SPINE_PITCH
RATE=4
PRELOAD_TORQUE=0
HINGE=DRV_SPINE_PITCH
PARITY=0

[REAR_DAMPER_0] ; chassis rear flex damper
DAMP_BUMP=200
DAMP_FAST_BUMP=200
DAMP_FAST_BUMPTHRESHOLD=0.1
DAMP_REBOUND=200
DAMP_FAST_REBOUND=200
DAMP_FAST_REBOUNDTHRESHOLD=0.1
BODY_A=CHASSIS
BODY_B=CHASSIS_FLEX_BODY_REAR
POS_A=-0.1, 0.5, 0
POS_B=-0.1, 0.0, 0
MIN_LENGTH=0.3
MAX_LENGTH=0.7
END_RATE=200
END_VTAPER=0.02
END_VMAX=0.2

[REAR_SPRING_0] ; HIPSPRING_LAT left
PULL_FORCE=0
POS_A=0.4585, 0.013, 0.409
POS_B=0.5485, 0.013, 0.409
BODY_A=CHASSIS
BODY_B=DRV_HIPS_TRANSLATE_LAT
RATE=38000
PARITY=0
BUMPSTOP_GAP=1

[REAR_SPRING_1] ; HIPSPRING_LAT right
PULL_FORCE=0
POS_A=0.6585, 0.013, 0.409
POS_B=0.5685, 0.013, 0.409
BODY_A=CHASSIS
BODY_B=DRV_HIPS_TRANSLATE_LAT
RATE=38000
PARITY=0
BUMPSTOP_GAP=1

[REAR_COILOVER_0] ; HIPSPRING_LAT damper
PULL_FORCE=0
RATE=0
BODY_A=CHASSIS
BODY_B=DRV_HIPS_TRANSLATE_LAT
PRELOAD=0.0
PRELOAD_FORCE=0
POS_A=0.4585, 0.013, 0.409
POS_B=0.6585, 0.013, 0.409
MIN_LENGTH=0.175
MAX_LENGTH=0.225
END_RATE=100000
END_VTAPER=0.02
END_VMAX=0.1
BUMPSTOP_GAP=0.02
PARITY=0
DAMP_BUMP=400
DAMP_FAST_BUMP=700
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=400
DAMP_FAST_REBOUND=700
DAMP_FAST_REBOUNDTHRESHOLD=0.05

[REAR_SPRING_2] ; HIPSPRING_LONG forwards
PULL_FORCE=0
POS_A=0.5585, 0.013, 0.509
POS_B=0.5585, 0.013, 0.419
BODY_A=DRV_HIPS_TRANSLATE_LAT
BODY_B=DRV_HIPS_TRANSLATE_LONG
RATE=10000 ; less force preventing forwards movement
PARITY=0
BUMPSTOP_GAP=1

[REAR_SPRING_3] ; HIPSPRING_LONG backwards
PULL_FORCE=0
POS_A=0.5585, 0.013, 0.309
POS_B=0.5585, 0.013, 0.399
BODY_A=DRV_HIPS_TRANSLATE_LAT
BODY_B=DRV_HIPS_TRANSLATE_LONG
RATE=15000
PARITY=0
BUMPSTOP_GAP=1

[REAR_COILOVER_1] ; HIPSPRING_LONG damper
PULL_FORCE=0
RATE=0
BODY_A=DRV_HIPS_TRANSLATE_LAT
BODY_B=DRV_HIPS_TRANSLATE_LONG
PRELOAD=0.0
PRELOAD_FORCE=0
POS_A=0.5585, 0.013, 0.309
POS_B=0.5585, 0.013, 0.509
MIN_LENGTH=0.15
MAX_LENGTH=0.25
END_RATE=100000
END_VTAPER=0.02
END_VMAX=0.1
BUMPSTOP_GAP=0.02
PARITY=0
DAMP_BUMP=400
DAMP_FAST_BUMP=700
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=400
DAMP_FAST_REBOUND=700
DAMP_FAST_REBOUNDTHRESHOLD=0.05

; NOTE: no VERT springs; driver "sits in seat" (rests on VERT damper bumpstops)

[REAR_COILOVER_2] ; HIPSPRING_VERT damper
PULL_FORCE=0
RATE=25000
BODY_A=DRV_HIPS_TRANSLATE_LONG
BODY_B=DRV_HIPS
PRELOAD=0.0
PRELOAD_FORCE=0
POS_A=0.5585, 0.113, 0.409
POS_B=0.5585, -0.087, 0.409
MIN_LENGTH=0.05
MAX_LENGTH=0.2
END_RATE=80000
END_VTAPER=0.02
END_VMAX=0.1
BUMPSTOP_GAP=0.02
PARITY=0
DAMP_BUMP=5
DAMP_FAST_BUMP=5
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=400
DAMP_FAST_REBOUND=700
DAMP_FAST_REBOUNDTHRESHOLD=0.05

[REAR_DAMPER_1] ; DRV_SPINE_PITCH damper
BODY_A=DRV_HIPS
BODY_B=DRV_CHEST
POS_A=0.5585, 0.113, 0.175
POS_B=0.5585, 0.3, 0.1
MIN_LENGTH=0.18
MAX_LENGTH=0.22
END_RATE=20000
END_VTAPER=0.02
END_VMAX=0.1
PARITY=0
DAMP_BUMP=5000
DAMP_FAST_BUMP=2500
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=7000
DAMP_FAST_REBOUND=4000
DAMP_FAST_REBOUNDTHRESHOLD=0.05

[REAR_COILOVER_3] ; DRV_SPINE_ROLL damper L
PULL_FORCE=0
RATE=35000
BODY_A=DRV_HIPS
BODY_B=DRV_CHEST
POS_A=0.4585, 0.113, 0.225
POS_B=0.4335, 0.35, 0.2
PRELOAD=0.0
PRELOAD_FORCE=0
MIN_LENGTH=0.23 ; limiting
MAX_LENGTH=0.3
END_RATE=20000
END_VTAPER=0.02
END_VMAX=0.1
BUMPSTOP_GAP=0.02
PARITY=0
DAMP_BUMP=2000
DAMP_FAST_BUMP=1500
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=2000
DAMP_FAST_REBOUND=1500
DAMP_FAST_REBOUNDTHRESHOLD=0.05

[REAR_COILOVER_4] ; DRV_SPINE_ROLL damper R
PULL_FORCE=0
RATE=35000
BODY_A=DRV_HIPS
BODY_B=DRV_CHEST
POS_A=0.6585, 0.113, 0.225
POS_B=0.6835, 0.35, 0.2
PRELOAD=0.0
PRELOAD_FORCE=0
MIN_LENGTH=0.23 ; limiting
MAX_LENGTH=0.3
END_RATE=20000
END_VTAPER=0.02
END_VMAX=0.1
BUMPSTOP_GAP=0.02
PARITY=0
DAMP_BUMP=2000
DAMP_FAST_BUMP=1500
DAMP_FAST_BUMPTHRESHOLD=0.05
DAMP_REBOUND=2000
DAMP_FAST_REBOUND=1500
DAMP_FAST_REBOUNDTHRESHOLD=0.05


[GRAPHICS_OFFSETS]
WHEEL_LF=-0.00					;Left front graphical offset of the wheel positioning in the x axis (width). + is left - is right movement
SUSP_LF=-0.00					;Left front graphical offset of the suspension positioning in the x axis (width). + is left - is right movement
WHEEL_RF=0.00					; Right front as above
SUSP_RF=0.00				; Right front as above
WHEEL_LR=-0.00					; Left rear as above
SUSP_LR=-0.00					; Left rear as above
WHEEL_RR=0.00					; Right rear as above
SUSP_RR=0.00				; Right rear as above

[DAMAGE]
MIN_VELOCITY=40				; MINUMUM VELOCITY TO START TAKING DAMAGE
GAIN=0.0000					; AMOUNT OF STEER ROD DEFLECTION FOR IMPACT KMH
MAX_DAMAGE=0.05			; MAXIMUM AMOUNT OF STEER ROD DEFLECTION ALLOWED
DEBUG_LOG=1					; ACTIVATES DAMAGE DEBUG IN THE LOG

